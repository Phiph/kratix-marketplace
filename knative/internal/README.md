# Development

## Build promise.yaml
The `promise.yaml` is generated by interpolating the contents of `resources/` into
the `workerClusterResources`.

These resources were downloaded from:
* https://github.com/knative/serving/releases/download/knative-v1.8.3/serving-crds.yaml


To build run:

```
./scripts/inject-wcr
```

## Docker image

The resources used in the pipeline were downloaded from:
* https://github.com/knative/serving/releases/download/knative-v1.8.3/serving-core.yaml
* https://github.com/knative/net-kourier/releases/download/knative-v1.8.1/kourier.yaml
* https://github.com/knative/serving/releases/download/knative-v1.8.3/serving-default-domain.yaml
* https://github.com/knative/serving/releases/download/knative-v1.8.3/serving-hpa.yaml


To build the image:
```
./scripts/docker build
```

To load the image to the local kind platform cluster:
```
./scripts/docker load
```

To push the image to ghcr.io:
```
./scripts/docker push
```

## Testing
To test the promise install kratix, and then:
```
kubectl apply -f promise.yaml
./scripts/test promise
```

This asserts the Promise is installed correctly.

To test the resource request:
```
kubectl apply -f resource-request.yaml
./scripts/test resource-request
```
